openapi: 3.0.3

info:
  title: API Usuarios
  description: >
    API encargada de la gestión de usuarios y autenticación.
    Funciona como puente entre el frontend (diseño atómico)
    y el backend con arquitectura hexagonal.
  version: "1.0.0"

servers:
  - url: http://localhost:3000
    description: Servidor local

tags:
  - name: User
    description: Operaciones relacionadas con usuarios

paths:
  /users:
    get:
      tags:
        - User
      summary: Obtener todos los usuarios
      description: Retorna la lista de usuarios registrados en el sistema
      operationId: getUsers
      responses:
        '200':
          description: Lista de usuarios
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorInternalServerError'
  /users/register:
    post:
      tags:
        - User
      summary: Crear usuario
      description: Crea un nuevo usuario en el sistema
      operationId: createUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserCreate'
      responses:
        '201':
          description: Usuario creado correctamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Datos inválidos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: Usuario ya existe
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorConflict'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorInternalServerError'
  /users/login:
    post:
      tags:
        - User
      summary: Login de usuario
      description: Autentica un usuario y retorna un token JWT
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login exitoso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          description: Datos incompletos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Credenciales inválidas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorUnauthorized'
        '404':
          description: Usuario no encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorNotFound'
        '500':
          description: Error interno del servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorInternalServerError'

components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        nombre:
          type: string
          example: Juan Pérez
        email:
          type: string
          format: email
          example: juan@email.com
        createdAt:
          type: string
          example: 2026-01-22T00:00:00.000Z
      required:
        - id
        - nombre
        - email

    UserCreate:
      type: object
      properties:
        name:
          type: string
          example: Juan Pérez
        email:
          type: string
          format: email
          example: juan@email.com
        password:
          type: string
          format: password
          example: "123456"
      required:
        - nombre
        - email
        - password

    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: juan@email.com
        password:
          type: string
          format: password
          example: "123456"
      required:
        - email
        - password

    LoginResponse:
      type: object
      properties:
        token:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

    ErrorResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 400
        message:
          type: string
          example: Datos inválidos

    ErrorUnauthorized:
      type: object
      properties:
        statusCode:
          type: integer
          example: 401
        message:
          type: string
          example: Credenciales inválidas
      
    ErrorForbidden:
      type: object
      properties:
        statusCode:
          type: integer
          example: 403
        message:
          type: string
          example: No tiene permisos
    
    ErrorNotFound:
      type: object
      properties:
        statusCode:
          type: integer
          example: 404
        message:
          type: string
          example: Usuario no encontrado
    
    ErrorConflict:
      type: object
      properties:
        statusCode:
          type: integer
          example: 409
        message:
          type: string
          example: El usuario ya existe
    
    ErrorInternalServerError:
      type: object
      properties:
        statusCode:
          type: integer
          example: 500
        message:
          type: string
          example: Error del servidor
      

